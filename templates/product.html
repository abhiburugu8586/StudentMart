{% extends "base.html" %}
{% block content %}
   {% if product['image_url'] %}
      <img src="{{ product['image_url'] }}"
     class="img-fluid mb-3 product-detail-img"
     alt="{{ product['name'] }}">

    {% endif %}
  <h1>{{ product['name'] }}</h1>
  <hr>
  <p class="text-muted">{{ product['category_name'] }}</p>
  <p>{{ product['description'] }}</p>
  <p class="fw-bold">Â£{{ '%.2f'|format(product['price']) }}</p>
  <p>Stock: {{ product['stock'] }}</p>

  <form method="post" action="{{ url_for('cart_add', product_id=product['id']) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <input type="number" name="qty" class="form-control mb-2" value="1" min="1" style="max-width:140px">
    <button class="btn btn-success">Add to Cart</button>
  </form>


  {% if session.get('user_id') == product['user'] %}
    <a class="btn btn-primary" href="{{ url_for('product_update', id=product['id']) }}">Update</a>
  {% endif %}
{% endblock %}

{% block sidebarContent %}
  {% if session.get('user_id') == product['user'] %}
  <div class="card text-center mt-3">
    <div class="card-body">
      <h5 class="card-title">Delete Product</h5>
      <form method="post" action="{{ url_for('product_delete', id=product['id']) }}" onsubmit="return confirm('Delete this product?');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <button class="btn btn-danger w-100" type="submit">Delete</button>
      </form>
    </div>
  </div>
  {% endif %}

  <div class="card text-center mt-3">
    <div class="card-body">
      <a class="btn btn-secondary w-100" href="{{ url_for('products') }}">Back to Products</a>
    </div>
  </div>
{% endblock %}
