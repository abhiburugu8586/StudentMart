{% extends "base.html" %}
{% block content %}
<h1>{{ title }}</h1>
<hr>

<form method="post" enctype="multipart/form-data" class="row g-3">
  <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

  <div class="col-12">
    <div class="form-floating">
      <input name="name" type="text" class="form-control" id="name" placeholder="Product name"
             value="{{ product['name'] if product else '' }}">
      <label for="name">Product Name</label>
    </div>
  </div>

  <div class="col-12">
    <div class="form-floating">
      <textarea name="description" class="form-control" id="description" style="height: 120px"
                placeholder="Description">{{ product['description'] if product else '' }}</textarea>
      <label for="description">Description</label>
    </div>
  </div>

  <div class="col-md-6">
    <div class="form-floating">
      <input name="price" type="number" step="0.01" class="form-control" id="price" placeholder="Price"
             value="{{ product['price'] if product else '' }}">
      <label for="price">Price (Â£)</label>
    </div>
  </div>

  <div class="col-md-6">
    <div class="form-floating">
      <input name="stock" type="number" class="form-control" id="stock" placeholder="Stock"
             value="{{ product['stock'] if product else 0 }}">
      <label for="stock">Stock</label>
    </div>
  </div>

  <div class="col-12">
    <label class="form-label">Upload Image (jpg, jpeg, png, webp)</label>
    <input class="form-control" type="file" name="image_file" accept=".jpg,.jpeg,.png,.webp">
    {% if product and product['image_url'] %}
      <div class="form-text">Current: {{ product['image_url'] }}</div>
    {% endif %}
  </div>

  <div class="col-12">
    <div class="form-floating">
      <input name="image_url" type="text" class="form-control" id="image_url" placeholder="Image URL"
             value="{{ product['image_url'] if product else '' }}">
      <label for="image_url">Image URL (optional fallback)</label>
    </div>
  </div>

  <div class="col-12">
    <div class="form-floating">
      <select name="category" class="form-select" id="category">
        {% for c in categories %}
          {% set selected = (product and product['category'] == c['id']) %}
          <option value="{{ c['id'] }}" {% if selected %}selected{% endif %}>{{ c['name'] }}</option>
        {% endfor %}
      </select>
      <label for="category">Category</label>
    </div>
  </div>

  <div class="col-12 text-center">
    <button class="btn btn-success w-100" type="submit">Save</button>
  </div>
</form>
{% endblock %}
